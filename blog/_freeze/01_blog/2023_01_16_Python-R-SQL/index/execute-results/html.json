{
  "hash": "c3131e64155398b44cf4dd6b83305da7",
  "result": {
    "markdown": "---\ntitle: \"Data Science Tools: Part 1: Python\"\nauthor: \"Randi Bolt\"\ndate: \"2023-01-16\"\ncategories: [SQL]\ntoc: true\ndraft: false\n---\n\nThis post covers XX data related questions, and solutions using  Python - R - SQL. \n\n![](../../00_img/ds_powerpuff.png)\n\n# `0.` Introduction \n\n## `0.1` Load Packages\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport pandas as pd\n\nfrom pandas import Series, DataFrame\n```\n:::\n\n\n# `1.` Create Data\n\n## `1.1` Python\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\npy_data = {'Letter': ['A', 'B', 'C'],\n            'Number': [1,2,3],\n            'Color': ['Blue','Red','Yellow']}\n            \npy_df = pd.DataFrame(py_data)\npy_df\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Letter</th>\n      <th>Number</th>\n      <th>Color</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>A</td>\n      <td>1</td>\n      <td>Blue</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>B</td>\n      <td>2</td>\n      <td>Red</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>C</td>\n      <td>3</td>\n      <td>Yellow</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## `1.2` R\n\n\n\n# `2.` Load Data\n\n## `2.1` Python\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\naddress = '../../00_data/patients.csv'\npy_patients = pd.read_csv(address)\npy_patients.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>patient_id</th>\n      <th>first_name</th>\n      <th>last_name</th>\n      <th>gender</th>\n      <th>birth_date</th>\n      <th>city</th>\n      <th>province_id</th>\n      <th>allergies</th>\n      <th>height</th>\n      <th>weight</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>Donald</td>\n      <td>Waterfield</td>\n      <td>M</td>\n      <td>1963-02-12</td>\n      <td>Barrie</td>\n      <td>ON</td>\n      <td>NaN</td>\n      <td>156</td>\n      <td>65</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>Mickey</td>\n      <td>Baasha</td>\n      <td>M</td>\n      <td>1981-05-28</td>\n      <td>Dundas</td>\n      <td>ON</td>\n      <td>Sulfa</td>\n      <td>185</td>\n      <td>76</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>Jiji</td>\n      <td>Sharma</td>\n      <td>M</td>\n      <td>1957-09-05</td>\n      <td>Hamilton</td>\n      <td>ON</td>\n      <td>Penicillin</td>\n      <td>194</td>\n      <td>106</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>Blair</td>\n      <td>Diaz</td>\n      <td>M</td>\n      <td>1967-01-07</td>\n      <td>Hamilton</td>\n      <td>ON</td>\n      <td>NaN</td>\n      <td>191</td>\n      <td>104</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>Charles</td>\n      <td>Wolfe</td>\n      <td>M</td>\n      <td>2017-11-19</td>\n      <td>Orillia</td>\n      <td>ON</td>\n      <td>Penicillin</td>\n      <td>47</td>\n      <td>10</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## `2.2` R\n\n\n# `3.` Show first name, last name, and gender of patients who's gender is 'M'.\n\n\n\n`SElECT` \n  column_1,\n  column_2,\n  column_4\n`FROM` data\n`WHERE` column_4 = 'value';\n\n\n# `4.` Show first and last name of patients who do not have allergies (null). \n\n`SElECT` \n  column_1,\n  column_2\n`FROM` data\n`WHERE` column_2 `IS` NULL\n\n# `5.` Show first name of patients that starts with the letter \"C\". \n\n`SElECT` \n  column_1\n`FROM` data\n`WHERE` column_1 `LIKE` 'A%'\n\n# `6.` Show first and last name of patients that weight within the range of 100 to 120 (inclusive).\n\n`SElECT` \n  column_1\n`FROM` data\n`WHERE` column_3 `BETWEEN` 100 `AND` 120\n\n# `7.` Replace NULL value with NKA in allegries column. \n\nUPDATE patients\n\tSET allergies = 'NKA'\n\tWHERE allergies IS NULL;\n\t\n# `8.` Show first and last as concatinated into one full_name column. \n\nselect \n\tCONCAT(first_name, ' ', last_name) AS full_name\nFROM patients\n\n# `9.` Show first name, last name, and the full province name of each patient. \n\n\n# `10.` Show how many patients have a birth_date with 1993 as the birth year. \n\n\n# `11.` Show all columns for patients who have one of the following patient_ids: 1, 45, 879, 1000. \n\n\n\n# `12.` Show unique first names from the patients table which only occurs once in the list. \n\n\n# `13.` Show patient_id, first_name, last_name from patients whos diagnosis is 'Dementia'. \n\n\n# `14.` Show the total amount of male patients and the toatl amount of female patients in the patients table. Display the results in the same row. \n\n\n# `15.` Show all allergies ordered by popularity. Remove 'NKA' or NULL values from query. \n\n\n# `16.` Show all of the days of the month (1-31) and how many admission_dates occurred on that day. Sort by the day with most admissions to least admissions. \n\n\n# `17.` For every admission, display the patient's full name, their admission diagnosis, and their doctor's full name who diagnosed their problem. \n\n# `18.` From the patients table, show patient_id, weight, height, and isObese. Display isObese as a boolean 0 or 1. Obese is defined as weight(kg)/height(m)$^2$)>= 30. Weight is in units kg, and height in in units cm. \n\n# `19.` For each day display the total amount of admissions on that day. Display the amount changed from the previous date. \n\n\n# `20.` Each admission costs $50 for patients without insurance, and $10 for patients with insurance. All patients with an even patient_id have insurance. Give each patient a 'Yes' if they have insurance, and a 'No' if they don't have insurance. Add up the admission_total cost for each has_insurance group. \n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}