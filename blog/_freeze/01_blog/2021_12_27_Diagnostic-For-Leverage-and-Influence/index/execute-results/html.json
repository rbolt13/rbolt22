{
  "hash": "7e9d0bfd82c91aa8c74050faa952f589",
  "result": {
    "markdown": "---\ntitle: \"Diagnostic For Leverage And Influence\"\ndate: \"2021-12-20\"\ncategories: [R, Linear Regression]\ntoc: true\n---\n\n\nThis post covers examples from Chapter 6 of [Introduction to Linear Regression Analysis](https://www.amazon.com/Introduction-Regression-Analysis-Douglas-Montgomery/dp/0470542810). \n\n# `1. Set Up`\n\nFor this analysis I will be using four packages: \n\n* magrittr: for piping (%>%)\n\n* dplyr: to arrange the data\n\n* MASS: to use the boxcox function\n\n* latex2exp: to put latex on graphs \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(latex2exp) \nlibrary(magrittr) \nlibrary(dplyr) \nlibrary(MASS) \n```\n:::\n\n\n# `2. Example 6.1: The Delivery Time Data`\n\n(Introduced in Chapter 3 Example 3.1) A soft drink bottler is analyzing the vending machine service routes in his distribution system. He is interested in predicting the amount of time required by the route driver to service the vending machines in an outlet. The service activity includes stocking the machine with beverage products and minor maintenance or housekeeping. The industrial engineer responsible for the study suggests that the two most important variables affecting the delivery time (y) are the number of cases of product stocked ($x_1$) and the distance walked by the route driver ($x_2$). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nex31 <- utils::read.csv(\"../../00_data/ex6-1.csv\")\nex31\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    X Observation Delivery_Time_y Number_of_Cases_x1 Distance_x2_.ft.\n1   1           1           16.68                  7              560\n2   2           2           11.50                  3              220\n3   3           3           12.03                  3              340\n4   4           4           14.88                  4               80\n5   5           5           13.75                  6              150\n6   6           6           18.11                  7              330\n7   7           7            8.00                  2              110\n8   8           8           17.83                  7              210\n9   9           9           79.24                 30             1460\n10 10          10           21.50                  5              605\n11 11          11           40.33                 16              688\n12 12          12           21.00                 10              215\n13 13          13           13.50                  4              255\n14 14          14           19.75                  6              462\n15 15          15           24.00                  9              448\n16 16          16           29.00                 10              776\n17 17          17           15.35                  6              200\n18 18          18           19.00                  7              132\n19 19          19            9.50                  3               36\n20 20          20           35.10                 17              770\n21 21          21           17.90                 10              140\n22 22          22           52.32                 26              810\n23 23          23           18.75                  9              450\n24 24          24           19.83                  8              635\n25 25          25           10.75                  4              150\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1 <- stats::lm(ex31$Delivery_Time_y ~ ex31$Number_of_Cases_x1 + ex31$Distance_x2_.ft., data = ex31)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nex31$hii <- stats::hatvalues(lm1)\nex31\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    X Observation Delivery_Time_y Number_of_Cases_x1 Distance_x2_.ft.\n1   1           1           16.68                  7              560\n2   2           2           11.50                  3              220\n3   3           3           12.03                  3              340\n4   4           4           14.88                  4               80\n5   5           5           13.75                  6              150\n6   6           6           18.11                  7              330\n7   7           7            8.00                  2              110\n8   8           8           17.83                  7              210\n9   9           9           79.24                 30             1460\n10 10          10           21.50                  5              605\n11 11          11           40.33                 16              688\n12 12          12           21.00                 10              215\n13 13          13           13.50                  4              255\n14 14          14           19.75                  6              462\n15 15          15           24.00                  9              448\n16 16          16           29.00                 10              776\n17 17          17           15.35                  6              200\n18 18          18           19.00                  7              132\n19 19          19            9.50                  3               36\n20 20          20           35.10                 17              770\n21 21          21           17.90                 10              140\n22 22          22           52.32                 26              810\n23 23          23           18.75                  9              450\n24 24          24           19.83                  8              635\n25 25          25           10.75                  4              150\n          hii\n1  0.10180178\n2  0.07070164\n3  0.09873476\n4  0.08537479\n5  0.07501050\n6  0.04286693\n7  0.08179867\n8  0.06372559\n9  0.49829216\n10 0.19629595\n11 0.08613260\n12 0.11365570\n13 0.06112463\n14 0.07824332\n15 0.04111077\n16 0.16594043\n17 0.05943202\n18 0.09626046\n19 0.09644857\n20 0.10168486\n21 0.16527689\n22 0.39157522\n23 0.04126005\n24 0.12060826\n25 0.06664345\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(influence.measures(lm1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nInfluence measures of\n\t stats::lm(formula = ex31$Delivery_Time_y ~ ex31$Number_of_Cases_x1 +      ex31$Distance_x2_.ft., data = ex31) :\n\n     dfb.1_ dfb.e31.N dfb.e31.D   dffit cov.r   cook.d    hat inf\n1  -0.18727   0.41131  -0.43486 -0.5709 0.871 1.00e-01 0.1018    \n2   0.08979  -0.04776   0.01441  0.0986 1.215 3.38e-03 0.0707    \n3  -0.00352   0.00395  -0.00285 -0.0052 1.276 9.46e-06 0.0987    \n4   0.45196   0.08828  -0.27337  0.5008 0.876 7.76e-02 0.0854    \n5  -0.03167  -0.01330   0.02424 -0.0395 1.240 5.43e-04 0.0750    \n6  -0.01468   0.00179   0.00108 -0.0188 1.200 1.23e-04 0.0429    \n7   0.07807  -0.02228  -0.01102  0.0790 1.240 2.17e-03 0.0818    \n8   0.07120   0.03338  -0.05382  0.0938 1.206 3.05e-03 0.0637    \n9  -2.57574   0.92874   1.50755  4.2961 0.342 3.42e+00 0.4983   *\n10  0.10792  -0.33816   0.34133  0.3987 1.305 5.38e-02 0.1963    \n11 -0.03427   0.09253  -0.00269  0.2180 1.172 1.62e-02 0.0861    \n12 -0.03027  -0.04867   0.05397 -0.0677 1.291 1.60e-03 0.1137    \n13  0.07237  -0.03562   0.01134  0.0813 1.207 2.29e-03 0.0611    \n14  0.04952  -0.06709   0.06182  0.0974 1.228 3.29e-03 0.0782    \n15  0.02228  -0.00479   0.00684  0.0426 1.192 6.32e-04 0.0411    \n16 -0.00269   0.06442  -0.08419 -0.0972 1.369 3.29e-03 0.1659    \n17  0.02886   0.00649  -0.01570  0.0339 1.219 4.01e-04 0.0594    \n18  0.24856   0.18973  -0.27243  0.3653 1.069 4.40e-02 0.0963    \n19  0.17256   0.02357  -0.09897  0.1862 1.215 1.19e-02 0.0964    \n20  0.16804  -0.21500  -0.09292 -0.6718 0.760 1.32e-01 0.1017    \n21 -0.16193  -0.29718   0.33641 -0.3885 1.238 5.09e-02 0.1653    \n22  0.39857  -1.02541   0.57314 -1.1950 1.398 4.51e-01 0.3916   *\n23 -0.15985   0.03729  -0.05265 -0.3075 0.890 2.99e-02 0.0413    \n24 -0.11972   0.40462  -0.46545 -0.5711 0.948 1.02e-01 0.1206    \n25 -0.01682   0.00085   0.00559 -0.0176 1.231 1.08e-04 0.0666    \n```\n:::\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}